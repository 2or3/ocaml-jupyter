OASISFormat:            0.4
Name:                   ocaml-jupyter
Version:                5.0.0
Synopsis:               An OCaml kernel for Jupyter notebooks
Authors:                Akinori ABE
License:                MIT
Plugins:                META (0.4), DevFiles (0.4)
OCamlVersion:           >= 4.01
BuildTools:             ocamlbuild,cppo
AlphaFeatures:          ocamlbuild_more_args
XOCamlbuildPluginTags:  package(cppo_ocamlbuild)
FilesAB:                lib/core/JupyterVersion.ml.ab

PreConfCommand:         ./git/init.sh

Library jupyter
  Path:                 lib/core
  FindlibName:          jupyter
  BuildDepends:         ppx_deriving_yojson
  XMETARequires:        ppx_deriving_yojson.runtime
  Modules:              Jupyter,
                        JupyterContentShell,
                        JupyterContentIopub,
                        JupyterContentStdin,
                        JupyterReplMessage,
                        JupyterJson,
                        JupyterHtml,
                        JupyterVersion

Library "jupyter-kernel"
  Path:                 lib/kernel
  FindlibName:          kernel
  FindlibParent:        jupyter
  BuildDepends:         jupyter, lwt, lwt.unix, yojson, lwt-zmq, nocrypto, uuidm,
                        lwt.ppx, ppx_deriving_yojson
  XMETARequires:        jupyter, lwt, lwt.unix, yojson, lwt-zmq, nocrypto, uuidm,
                        lwt.ppx, ppx_deriving_yojson.runtime
  Modules:              JupyterServer,
                        JupyterConnectionInfo,
                        JupyterMessageChannel,
                        JupyterMessage,
                        JupyterZmqChannel,
                        JupyterChannelIntf,
                        JupyterHmac,
                        JupyterLog
  Install:              false

Library "jupyter-repl"
  Path:                 lib/repl
  FindlibName:          repl
  FindlibParent:        jupyter
  BuildDepends:         jupyter.kernel, compiler-libs.common, compiler-libs.toplevel, lwt, lwt.unix, lwt.ppx
  XMETARequires:        jupyter.kernel, compiler-libs.common, compiler-libs.toplevel, lwt, lwt.unix
  Modules:              JupyterRepl,
                        JupyterReplProcess,
                        JupyterReplToploop,
                        JupyterReplError
  Install:              false
  CompiledObject:       byte

Executable "ocaml-jupyter"
  Path:                 src
  MainIs:               JupyterMain.ml
  BuildDepends:         jupyter, jupyter.kernel, jupyter.repl
  CompiledObject:       byte

##
## Tests
##

Executable test_lib
  Path:                 test
  MainIs:               TestJupyter.ml
  Build$:               flag(tests)
  Install:              false
  BuildDepends:         jupyter.kernel, jupyter.repl, str, ppx_deriving.show, oUnit
  CompiledObject:       byte

Test test_lib
  Run$:                 flag(tests)
  Command:              $test_lib -runner sequential
  WorkingDirectory:     test
